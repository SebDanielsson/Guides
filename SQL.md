# SQL Cheatsheet

## Create tablespace

``` sql
CREATE TABLESPACE data
  DATAFILE 'data01.dbf'
  SIZE 1024M
  EXTENT MANAGEMENT LOCAL
  SEGMENT SPACE MANAGEMENT AUTO
  ONLINE;
```

## Create user

``` sql
CREATE USER sebastian
  IDENTIFIED BY Y!Wm*VT7_DdJ
  DEFAULT TABLESPACE data
  QUOTA 10M ON data
  TEMPORARY TABLESPACE temp
  QUOTA 5M ON system
  ACCOUNT UNLOCK;
```

## Database commands

### Create database

``` sql
CREATE DATABASE store;
```

### Drop database

``` sql
DROP DATABASE store;
```

## Table commands

### Create table

``` sql
CREATE TABLE customers (
  customer_id NUMBER(10) GENERATED BY DEFAULT AS IDENTITY,
  first_name VARCHAR2(64) NOT NULL,
  last_name VARCHAR2(64) NOT NULL,
  email VARCHAR2(254) NOT NULL,
  mobile NUMBER(15),
  testing NUMBER(10)
);
```

### Rename table

``` sql
ALTER TABLE customers RENAME TO persons;
```

### Delete table

``` sql
DROP TABLE customers;
```

### Add column

``` sql
ALTER TABLE customers ADD column ssn NUMBER(12) NOT NULL;

ALTER TABLE customers ADD (
  ssn NUMBER(12) NOT NULL,
  birthdate DATE NULL
);
```

### Modify column

``` sql
ALTER TABLE customers MODIFY ssn NUMBER(12) NOT NULL;

ALTER TABLE customers MODIFY (
  ssn NUMBER(12) NOT NULL,
  birthdate DATE NOT NULL
);
```

### Create sequence

``` sql
CREATE SEQUENCE seq_testing
  START WITH 1
  INCREMENT BY 1;
```

### Insert using sequence

``` sql
INSERT INTO customers (first_name, last_name, email, testing)
  VALUES ('Sebastian','Danielsson','sebastian@du.se',seq_testing.nextval);
```

### Manage constraints

#### Constraint types

* Primary key - pk
* Foreign key - fk
  x
* Check - ck
  | Operator | Description |
  | -------- | ----------- |
  | BETWEEN 10 AND 15 | Between |
  | =10      | Equal       |
  | !=10     | Not equal   |
  | <10      | Less than   |
  | >10      | More than   |
  | >=10     | Greater than or equal |
  | <=10     | Less than or equal |
  | !<10     | Not Less Than |
  | !>10     | Not Greater Than |
* Unique - uq

#### Add constraints

``` sql
ALTER TABLE customers
  ADD CONSTRAINT customer_customer_id_pk PRIMARY KEY(customer_id)
  ADD CONSTRAINT customer_ssn_fk FOREIGN KEY(col1) REFERENCES test_customers(col1)
  ADD CONSTRAINT customer_testing_ck CHECK (testing BETWEEN 16 AND 128)
  ADD CONSTRAINT customer_testing_ck CHECK (email IN('abc','cba','xyz'))
  ADD CONSTRAINT customer_email_uq UNIQUE(email);
```

#### Rename constraint

``` sql
ALTER TABLE customers
  RENAME CONSTRAINT customer_customer_id_pk TO customer_customerid_pk;
```

#### Drop constraint

``` sql
DROP CONSTRAINT customer_email_uq;
```

#### Rename column

``` sql
ALTER TABLE customers
  RENAME COLUMN first_name TO forename;
```

### Drop column

``` sql
ALTER TABLE customers
  DROP COLUMN ssn;

ALTER TABLE customers DROP (
  ssn
  mobile
);
```

## Manage data

### Add row to table

``` sql
INSERT INTO customers (first_name,last_name,email)
  VALUES ('Sebastian','Danielsson','sebastian.danielsson@oracle.com');
```

### Alter data for one row

``` sql
UPDATE customers SET last_name = 'Danielsson',email = 'sebastian.danielsson@postgres.com' WHERE customer_id = 3;
```

### Delete row

``` sql
DELETE
FROM
  customers
WHERE
  customer_id = 3;
```

### Delete all rows from table

``` sql
DELETE FROM customers;
```

## Browse database

### Show all tables on database

``` sql
SELECT table_name FROM dba_tables;
```

### Show tables accessible by user

``` sql
SELECT table_name
FROM all_tables
ORDER BY table_name;
```

### Show tables owned by user

``` sql
SELECT *
FROM all_tables
WHERE OWNER = 'sebastian'
ORDER BY table_name;
```

### Show data for all columns

``` sql
SELECT * FROM CUSTOMERS;
```

### Show data for specific columns

``` sql
SELECT first_name,last_name FROM CUSTOMERS;
```

### Show rows matching data

``` sql
SELECT *
FROM customers
WHERE customer_id = 3;
```
